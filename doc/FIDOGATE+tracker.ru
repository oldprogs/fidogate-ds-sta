
    $Id: FIDOGATE+tracker.ru,v 5.1 2004/12/10 19:09:49 anray Exp $

Настройка трекера для совместной работы с FidoGate.

Прежде чем приступать к установке трекера необходимо понимать как работает
FidoGate (FG). Я не буду здесь описывать элементарные вопросы, такие как "для
чего нужен runinc?". Все это описано в FAQ и в документации. Я остановлюсь
только на совместной работе трекера с FG.


FG представляет собой комплекс программ которые по очереди запускаются runinc:
ftntoss, ftnroute, ftnpack, и т.д.

Пришедшая почта распаковывается runinc'ом в inbound и на пакетики натравливается
ftntoss. Если FG был собран с --dnt-netmail, то после работы ftntoss все мыло
попадает в netmaildir а остальная почта в toss/route. Все remap'ы (см.
настройку роботов в route и packing) отрабатывают уже на этом этапе. Чтобы
отключить remap'ы напишите NoRewrite в fidogate.conf (работает только при сборке
с --dnt-netmail).

Теперь на почту в toss/route натравливаются ftnroute и ftnpack в результате
чего почта раскладывается на линков и гейтуется (см. настройку progn gate в
packing).

Трекер запускается после того как отработает runinc. Он смотрит на пакетики в
netmaildir и решает что с ними делать дальше. Всё что предназначено для нашей
системы трекер должен положить в toss/route. Любое транзитное мыло должно
раскладываться на линков самостоятельно трекером. Если в toss/route положить
транзитное мыло, то FG опять положит его в netmaildir.

Чтобы мыло, лежащее в toss/route, сгейтовалось нужно запустить ftnpack --pkt.
ftnpack посмотрит в packing и выполнит для пакетика соответствующий progn (см.
настройки progn gate, areafix, filefix в packing).

Исходящее мыло с нашей системы кладется в outpkt (ответы роботов) или в
outpkt/mail (сгейтованый e-mail). Трекер должен самостоятельно раскладывать
эти пакетики на линков.

Также при настройке трекера следует помнить что fidogate ничего не знает ни
про какие squish'ы или jam'ы и работает только с *.pkt.

Например, скрипты тоссинга могут быть такими:

------ tossin --------
#! /bin/sh

# тоссим почту
runinc -a /path_to/uuedec.pl

# запускаем трекер для обработки входящей почты. вся почта из netmaildir
# перекладывается в toss/route (procin.pl). транзитная почта отправляется
# дальше, почта для нас и для роботов остается в toss/route (procout.pl)
itraxp -c itraxp.cfg procin.pl procout.pl

# гейтуем то что у нас лежит в toss/route
/usr/local/libexec/ftnpack --pkt
-----------------------

------ tossout --------
#! /bin/sh

# исходящее мыло (outpkt, outpkt/mail) раскладывается на линков
itraxp -c itraxp.cfg procout.pl

# гейтуются news'ы
/usr/local/libexec/send-fidogate

# сгейтованные news'ы (outpkt/news) раскладываются на линков
runinc -o
-----------------------



Q: Какой трекер лучше всего подходит для работы с FG?
A: Подойдет любой трекер, но мне больше всего нравится itraxp. В качестве
   конфигов для itraxp'а используются перловые скрипты, что дает ему большИе
   возможности и гибкость настройки. Если вы не знаете perl'а можете
   попробовать FTrack.

Q: Обязательно ли собирать FG с --dnt-netmail.
A: Если вы собираетесть использовать трекер, желательно собрать FG с
   --dnt-netmail. Если FG будет собран без этой опции, некоторое мыло может
   пройти мимо трекера (например, мыло которое придет во время тоссинга,
   трекеру врядли достанется).


Если есть замечания или дополнения пишите на bey0nd что на mail.ru или
						      Andrew Zhuravlev на 2:5035/67

